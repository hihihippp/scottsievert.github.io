
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Speckle and Lasers - Scott Sievert</title>
  <meta name="author" content="Scott Sievert">

  
  <meta name="description" content="We know that lasers are very accurate instruments and emit a very precise
wavelength and hence are in an array of precision applications including &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://scottsievert.github.io/blog/2014/05/18/speckle-and-lasers">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Scott Sievert" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Noto+Serif:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>

  

</head>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Scott Sievert</a></h1>
  
    <h2>Carefully curated musings on math, python and skiing.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  
  
</ul>

<ul class="main-navigation">
  <li><a href="/about/">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="https://github.com/scottsievert">Github</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/atom.xml">RSS</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Speckle and Lasers</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-18T09:26:40-05:00" pubdate data-updated="true">May 18<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>We know that lasers are very accurate instruments and emit a very precise
wavelength and hence are in an array of precision applications including
<a href="https://en.wikipedia.org/wiki/Bloodless_surgery">bloodless surgery</a>, <a href="https://en.wikipedia.org/wiki/Laser_eye_surgery_(disambiguation)">eye surgery</a> and 
<a href="https://en.wikipedia.org/wiki/Fingerprint">fingerprint detection</a>. 
So why do we see random light/dark spots
when we shine a laser on anything? Shouldn’t it all be the same color since
lasers are deterministic (read: not random)?  To answer that question<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, we
need to delve into optical theory.</p>

<!--More-->

<p><a href="https://en.wikipedia.org/wiki/Coherence_(physics)"><em>Coherent</em> optical systems</a> are simply defined to be
<em>deterministic</em> systems. That’s a big definition, so let’s break it into
pieces. Coherent systems are where you know the wavelength and phase of every
ray. Lasers are very coherent (one wavelength, same phase) while sunlight is
not coherent (many wavelength, different phases).</p>

<p>Deterministic is just a way of saying everything about the system is known and
there’s no randomness. Sunlight is not deterministic because there are many
random processes. Photons are randomly generated and there are many
wavelengths. Sunspots are one example of the randomness present in sunlight.</p>

<p>But if lasers are coherent and deterministic, why do we see speckle (read:
bright and dark spots) when we see a laser spot? The speckle is random; we
can’t predict where every dark spot will be. The randomness of this laser spot
and the fact that lasers are deterministic throws a helluva question at us. It
turns out <em>what</em> we see the laser on is important, but let’s look at the math
and physics behind it.</p>

<p>Coherent optical systems have a very special property. Their 
<a href="https://en.wikipedia.org/wiki/Impulse_response">impulse response</a> (read: reaction to a standardized input)
in the frequency domain is just the pupil function.  For those familiar with
the parlance and having $f_x$ be a spatial frequency as opposed to a time
frequency,</p>

<script type="math/tex; mode=display">H\left( f_x, f_y\right) = P(-\lambda z x, -\lambda z y) </script>

<p>When I saw this derived<sup id="fnref:3"><a href="#fn:3" rel="footnote">2</a></sup>, I thought “holy shit.” If you just want to only pass high
frequency spatial content (read: edges), then all that’s required it to not let
light through the center of the lens.</p>

<p><img class="right" src="https://raw.githubusercontent.com/scottsievert/side-projects/master/speckle/impulse_respone.png" width="200" /></p>

<p>Since this system is linear, we can think of our output as bunch of impulse
responses shifted in space and scaled by the corresponding amount. This is the
definition of <a href="https://en.wikipedia.org/wiki/Convolution">convolution</a> and only works because this is a 
<a href="https://en.wikipedia.org/wiki/LTI_system_theory">linear and space invariant system.</a></p>

<p>To find our impulse response in the space domain, $h\left( x, y\right) $, we
have to take the Fourier transform (aka FFT) of our pupil. Since our pupil
function is symmetric, the inverse Fourier transform and forward Fourier
transform <a href="https://en.wikipedia.org/wiki/Fourier_transform#Invertibility_and_periodicity">are equivalent</a>.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># a circular pupil</span>
</span><span class="line"><span class="n">pupil</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
</span><span class="line"><span class="n">i</span> <span class="o">=</span> <span class="n">argwhere</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span class="line"><span class="n">pupil</span><span class="p">[</span><span class="n">i</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class="line">
</span><span class="line"><span class="n">h</span> <span class="o">=</span> <span class="n">fft2</span><span class="p">(</span><span class="n">pupil</span><span class="p">)</span> <span class="c"># our impulse response since H(fx) = P(x)</span>
</span><span class="line"><span class="n">h</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<!--plane wave spectrum-->
<p>Through the angular plane wave spectrum, this impulse response can be viewed as
a series plane waves coming in at different angles, shown in the figure below.</p>

<p><img class="right" src="https://raw.githubusercontent.com/scottsievert/side-projects/master/speckle/apws.png" width="200" /></p>

<p>What angles can a wave be thought of as? The frequency content and angles turn
out to be related, since two planes waves of a constant frequency adding
together can have a change in frequency depending on what angle they’re at,
which makes intuitive sense. Or, our spatial plane wave $U(x,y)$ can be
represented by the Fourier transform:</p>

<script type="math/tex; mode=display">\textrm{APWS}(\theta_x, \theta_y) = \mathcal{F}\left\{ U(x,y) \right\}\rvert_{f_x = \theta_x/\lambda}</script>

<p>The wall which the laser is shining on is not smooth and perfectly flat. It’s
rough, and the distance adds a phase difference between two waves<sup id="fnref:2"><a href="#fn:2" rel="footnote">3</a></sup>. Through the
<a href="https://en.wikipedia.org/wiki/Random_walk">Drunkard’s Walk</a> and the angular plane wave spectrum, if we could
obtain every angle, the laser spot wouldn’t have any speckle. Our eyes are finite in
size, so we can’t obtain every angle or frequency.</p>

<p>Because the wall gives the wave some random phase, we can represent the spot we
see by a 2D convolution with a random phase and the impulse response. This
convolution is just saying that every spot gives the same response multiplied
by some random phase, added together for every point.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">x</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">1j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span> <span class="c"># a bunch of random phases</span>
</span><span class="line"><span class="n">x</span> <span class="o">*=</span> <span class="n">p</span> <span class="c"># only within the pupil</span>
</span><span class="line">
</span><span class="line"><span class="n">d</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">10</span> <span class="c"># delta since our eyes aren&#39;t infinitely big</span>
</span><span class="line"><span class="n">y</span> <span class="o">=</span> <span class="n">convolve2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">d</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">d</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="p">])</span> <span class="c"># an approximation with d</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The laser spot <code>y</code> shows some speckle! The speckle varies with how large we
make <code>d</code> (really <code>delta</code> but that’s long); if we include more frequencies and
more of the impulse response, the dots get smaller. To see this, if you hold a
pinhole up to your eye, the speckles will appear larger.</p>

<p><img class="center" src="https://raw.githubusercontent.com/scottsievert/side-projects/master/speckle/speckle.png" width="500" /></p>

<p>An intuitive way to think about this involves the impulse response. The impulse
response changes on with the distance and so does the phase. Certain areas add
up to 0 while others add up to 1. There’s a whole probability density function
that goes with that, but that’s goes further into optical and statistical
theory.</p>

<p><strong>tl;dr:</strong> the roughness of the walls add uncertainty in phase and hence speckle</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>the <a href="https://github.com/scottsievert/side-projects/tree/master/speckle">full code</a> is available on Github.<a href="#fnref:1" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>This does rely on assumptions by Goodman. Refer to Eqn. 6-20 for more detail (and thanks Mint!)<a href="#fnref:3" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>reddit commenter <a href="http://www.reddit.com/r/Optics/comments/25zyxa/why_are_laser_spots_speckled/chmg1p2">delmar15</a> pointed out that there’s also phase due to the glass it’s shining through (and many other effects). <a href="http://www.amazon.com/Statistical-Optics-Joseph-W-Goodman/dp/0471399167">Statisitcal optics</a> covers that in much more detail.<a href="#fnref:2" rel="reference">&#8617;</a></p>
    </li>
  </ol>
</div>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Scott Sievert</span></span>

      








  


<time datetime="2014-05-18T09:26:40-05:00" pubdate data-updated="true">May 18<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/math/'>math</a>, <a class='category' href='/blog/categories/optics/'>optics</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://scottsievert.github.io/blog/2014/05/18/speckle-and-lasers/" data-via="" data-counturl="http://scottsievert.github.io/blog/2014/05/18/speckle-and-lasers/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/05/14/Scientific-Python-tips-and-tricks/" title="Previous Post: Scientific Python tips and tricks">&laquo; Scientific Python tips and tricks</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/05/27/fourier-transforms-and-optical-lenses/" title="Next Post: Fourier transforms and optical lenses">Fourier transforms and optical lenses &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

  <aside class="sidebar">
   
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:scottsievert.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/06/03/parallel-python/">Parallel Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/27/fourier-transforms-and-optical-lenses/">Fourier Transforms and Optical Lenses</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/18/speckle-and-lasers/">Speckle and Lasers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/14/Scientific-Python-tips-and-tricks/">Scientific Python Tips and Tricks</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/14/predicting-the-weather/">Predicting the Weather</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/scottsievert">@scottsievert</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'scottsievert',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Scott Sievert -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<!--scott: commented out to remove sticky header-->
<!--<script>-->
  <!--$(document).ready(function() {  -->
  <!--var stickyNavTop = $('nav').offset().top;  -->
    
  <!--var stickyNav = function(){  -->
  <!--var scrollTop = $(window).scrollTop();  -->
         
  <!--if (scrollTop > stickyNavTop) {   -->
      <!--$('nav').addClass('sticky');  -->
  <!--} else {  -->
      <!--$('nav').removeClass('sticky');   -->
  <!--}  -->
  <!--};  -->
    
  <!--stickyNav();  -->
    
  <!--$(window).scroll(function() {  -->
      <!--stickyNav();  -->
  <!--});  -->
  <!--});  -->
<!--</script>-->


</body>
</html>
